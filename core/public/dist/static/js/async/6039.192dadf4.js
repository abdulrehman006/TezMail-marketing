"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["6039"],{60045(e,t,l){l.d(t,{h:()=>o});var a=l(90290),n=l(98179);let r=Symbol("MODAL_INJECT"),o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{state:t={},component:l,onCancel:o,onConfirm:u}=e,i=(0,a.Kh)({});return l?[(0,a.pM)({setup(n,o){let{attrs:u,slots:s}=o;return(0,a.Gt)(r,{state:t,options:e,extendApi:e=>{Object.setPrototypeOf(i,e)},setState:e=>{Object.assign(t,e)}}),()=>(0,a.h)(l,{...n,...u},s)}}),i]:[(0,a.pM)({setup(t,l){let{attrs:s,slots:d}=l,p=(0,a.WQ)(r),c=(0,a.KR)(!1);return i.open=()=>{var t;c.value=!0,null==(t=e.onChangeState)||t.call(e,c.value)},i.close=()=>{c.value=!1},i.setState=t=>{var l;null==p||p.setState(t),null==(l=e.onChangeState)||l.call(e,c.value)},i.getState=()=>(null==p?void 0:p.state)??{},null==p||p.extendApi(i),()=>(0,a.bF)(n.A,(0,a.v6)({show:c.value},t,s,{onCancel:o,onConfirm:u,"onUpdate:show":e=>{c.value=e??!1}}),d)}}),i]}},13665(e,t,l){l.d(t,{A:()=>r});var a=l(62408),n=l(90290);let r=(0,n.pM)({__name:"index",props:{model:{},rules:{},labelWidth:{},labelPlacement:{default:"top"}},setup(e,t){let{expose:l}=t,r=(0,n.KR)(null);return l({validate:()=>{var e;return null==(e=r.value)?void 0:e.validate()},restoreValidation:()=>{var e;return null==(e=r.value)?void 0:e.restoreValidation()}}),(t,l)=>{let o=a.A;return(0,n.uX)(),(0,n.Wv)(o,(0,n.v6)(t.$attrs,{ref_key:"formRef",ref:r,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement}),{default:(0,n.k6)(()=>[(0,n.RG)(t.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},64394(e,t,l){l.r(t),l.d(t,{default:()=>W});var a=l(63919),n=l(23618),r=l(77625),o=l(28391),u=l(90216),i=l(90290),s=l(27546),d=l(85684),p=l(97786),c=l(12532),m=l(60045),g=l(80111),v=l(63114),f=l(2429),b=l(34020),_=l(13665),h=l(95403),k=l(45449),y=l(60801);let R={class:"flex-1 mr-12px"},A=(0,i.pM)({__name:"TagSelect",props:(0,i.zz)({groupId:{type:Number,default:0}},{value:{default:()=>[]},valueModifiers:{}}),emits:["update:value"],setup(e){let t=(0,i.fn)(e,"value"),l=(0,i.KR)(!1),a=(0,i.KR)([]),n=(0,i.EW)(()=>a.value.filter(t=>t.group_id===e.groupId).map(e=>({label:e.name,value:e.id}))),r=async()=>{try{l.value=!0;let e=await (0,v.cl)({});(0,c.Gv)(e)&&(a.value=e.list)}finally{l.value=!1}};r(),(0,i.wB)(()=>e.groupId,e=>{t.value=a.value.filter(t=>t.group_id===e).map(e=>e.id)});let[o,u]=(0,m.h)({component:b.A,state:{refresh:r}}),d=()=>{u.setState({row:null,isEdit:!1,groupId:e.groupId}),u.open()};return(e,a)=>{let r=h.A,u=s.Ay;return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",R,[(0,i.bF)(r,{value:t.value,"onUpdate:value":a[0]||(a[0]=e=>t.value=e),loading:(0,i.R1)(l),tag:!0,multiple:!0,filterable:!0,options:(0,i.R1)(n)},null,8,["value","loading","options"])]),(0,i.bF)(u,{type:"primary",text:"",onClick:d},{default:(0,i.k6)(()=>[(0,i.eW)((0,i.v_)(e.$t("common.actions.create")),1)]),_:1}),(0,i.bF)((0,i.R1)(o))],64)}}});var F=l(3401);let x=(0,i.pM)({__name:"TagBulk",setup(e){let{t}=(0,F.s9)(),l=(0,i.Kh)({group_id:null,tag_ids:[],data:"",mark_include:1}),a=(0,i.EW)(()=>[{label:t("contacts.tags.bulk.actions.tagThese"),value:1},{label:t("contacts.tags.bulk.actions.tagExcept"),value:0}]),[n]=(0,m.h)({onChangeState:()=>{l.group_id=null,l.tag_ids=[],l.data="",l.mark_include=1},onConfirm:async()=>{await (0,v.Hh)({group_id:l.group_id||0,tag_ids:l.tag_ids,data:l.data,mark_include:l.mark_include})}});return(e,r)=>{let o=y.Ay,u=k.A,s=h.A,d=_.A;return(0,i.uX)(),(0,i.Wv)((0,i.R1)(n),{title:(0,i.R1)(t)("contacts.tags.bulk.title"),width:"560"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{ref:"formRef",class:"pt-16px",model:(0,i.R1)(l)},{default:(0,i.k6)(()=>[(0,i.bF)(o,{label:(0,i.R1)(t)("contacts.tags.bulk.form.group"),path:"group_id"},{default:(0,i.k6)(()=>[(0,i.bF)(f.A,{value:(0,i.R1)(l).group_id,"onUpdate:value":r[0]||(r[0]=e=>(0,i.R1)(l).group_id=e)},null,8,["value"])]),_:1},8,["label"]),(0,i.bF)(o,{label:(0,i.R1)(t)("contacts.tags.bulk.form.tags"),path:"tag_ids"},{default:(0,i.k6)(()=>[(0,i.bF)(A,{value:(0,i.R1)(l).tag_ids,"onUpdate:value":r[1]||(r[1]=e=>(0,i.R1)(l).tag_ids=e),groupId:(0,i.R1)(l).group_id},null,8,["value","groupId"])]),_:1},8,["label"]),(0,i.bF)(o,{label:(0,i.R1)(t)("contacts.tags.bulk.form.emails"),path:"data"},{default:(0,i.k6)(()=>[(0,i.bF)(u,{value:(0,i.R1)(l).data,"onUpdate:value":r[2]||(r[2]=e=>(0,i.R1)(l).data=e),type:"textarea",rows:5,placeholder:(0,i.R1)(t)("contacts.tags.bulk.form.emailsPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,i.bF)(o,{label:(0,i.R1)(t)("contacts.tags.bulk.form.action"),path:"mark_include"},{default:(0,i.k6)(()=>[(0,i.bF)(s,{value:(0,i.R1)(l).mark_include,"onUpdate:value":r[3]||(r[3]=e=>(0,i.R1)(l).mark_include=e),options:(0,i.R1)(a)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}});var w=l(75220);let C={class:"w-200px"};function S(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,i.vv)(e)}let W=(0,i.pM)({__name:"index",setup(e){let t=(0,p.ZDG)(),{t:l}=(0,F.s9)(),{tableProps:_,pageProps:h,tableParams:k,fetchTable:y}=(0,g.u)({params:{keyword:"",group_id:t.value.state.group_id||0,page:1,page_size:10},useParams:e=>({...e,group_id:e.group_id||void 0}),fetchFn:v.Tn}),R=(0,i.KR)([{key:"name",title:l("contacts.tags.columns.name"),minWidth:120,ellipsis:{tooltip:!0},render:e=>(0,i.bF)(s.Ay,{type:"primary",text:!0,onClick:()=>{W(e)}},{default:()=>[e.name]})},{key:"group_name",title:l("contacts.tags.columns.groupName"),minWidth:120,ellipsis:{tooltip:!0}},{key:"create_time",title:l("contacts.tags.columns.createTime"),minWidth:140,render:e=>(0,c.fU)(e.create_time)},{key:"action",title:l("contacts.tags.columns.actions"),align:"right",width:180,render:e=>{let t,a,n;return(0,i.bF)(d.A,{inline:!0},{default:()=>[(0,i.bF)(s.Ay,{type:"primary",text:!0,onClick:()=>{W(e)}},S(t=l("common.actions.view"))?t:{default:()=>[t]}),(0,i.bF)(s.Ay,{type:"primary",text:!0,onClick:()=>{M(e)}},S(a=l("common.actions.edit"))?a:{default:()=>[a]}),(0,i.bF)(s.Ay,{type:"error",text:!0,onClick:()=>{U(e)}},S(n=l("common.actions.delete"))?n:{default:()=>[n]})]})}}]),A=(0,w.rd)(),W=e=>{A.push({path:"/contacts/subscribers",state:{group_id:e.group_id,tag_id:e.id}})},[I,E]=(0,m.h)({component:b.A,state:{refresh:y}}),j=()=>{E.setState({row:null,isEdit:!1,groupId:k.value.group_id}),E.open()},M=e=>{E.setState({row:e,isEdit:!0}),E.open()},U=e=>{(0,c.lJ)({title:l("contacts.tags.delete.title"),content:l("contacts.tags.delete.confirm",{name:e.name}),onConfirm:async()=>{await (0,v._R)({id:e.id}),y()}})},[z,K]=(0,m.h)({component:x,state:{refresh:y}}),O=()=>{K.open()};return(e,t)=>{let d=u.A,p=o.A,c=r.A,m=n.A,g=a.A;return(0,i.uX)(),(0,i.Wv)(g,null,{toolsLeft:(0,i.k6)(()=>[(0,i.bF)((0,i.R1)(s.Ay),{type:"primary",onClick:j},{default:(0,i.k6)(()=>[(0,i.eW)((0,i.v_)((0,i.R1)(l)("contacts.tags.addTag")),1)]),_:1}),(0,i.bF)((0,i.R1)(s.Ay),{onClick:O},{default:(0,i.k6)(()=>[(0,i.eW)((0,i.v_)((0,i.R1)(l)("contacts.tags.bulkTag")),1)]),_:1})]),toolsRight:(0,i.k6)(()=>[(0,i.Lk)("div",C,[(0,i.bF)(f.A,{value:(0,i.R1)(k).group_id,"onUpdate:value":[t[0]||(t[0]=e=>(0,i.R1)(k).group_id=e),t[1]||(t[1]=()=>(0,i.R1)(y)(!0))],all:!0},null,8,["value"])]),(0,i.bF)(d,{value:(0,i.R1)(k).keyword,"onUpdate:value":t[2]||(t[2]=e=>(0,i.R1)(k).keyword=e),width:240,placeholder:(0,i.R1)(l)("contacts.tags.searchPlaceholder"),onSearch:t[3]||(t[3]=()=>(0,i.R1)(y)(!0))},null,8,["value","placeholder"])]),table:(0,i.k6)(()=>[(0,i.bF)(c,(0,i.v6)((0,i.R1)(_),{columns:(0,i.R1)(R)}),{empty:(0,i.k6)(()=>[(0,i.bF)(p)]),_:1},16,["columns"])]),pageRight:(0,i.k6)(()=>[(0,i.bF)(m,(0,i.v6)((0,i.R1)(h),{onRefresh:(0,i.R1)(y)}),null,16,["onRefresh"])]),modal:(0,i.k6)(()=>[(0,i.bF)((0,i.R1)(I)),(0,i.bF)((0,i.R1)(z))]),_:1})}}})},85684(e,t,l){l.d(t,{A:()=>g});var a=l(44041),n=l(90290),r=l(49359),o=l(50922),u=l(79623),i=l(75454),s=l(69598),d=l(14957),p=l(20649);let c={name:"Flex",self:function(){return p.A}},m=Object.assign(Object.assign({},r.A.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),g=(0,n.pM)({name:"Flex",props:m,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:l}=(0,o.Ay)(e),s=(0,r.A)("Flex","-flex",void 0,c,e,t);return{rtlEnabled:(0,u.I)("Flex",l,t),mergedClsPrefix:t,margin:(0,n.EW)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,i.cF)("gap",t)]:l}}=s.value,{row:n,col:r}=(0,a.t8)(l);return{horizontal:(0,a.eV)(r),vertical:(0,a.eV)(n)}})}},render(){let{vertical:e,reverse:t,align:l,inline:a,justify:r,margin:o,wrap:u,mergedClsPrefix:i,rtlEnabled:p}=this,c=(0,s.B)((0,d.$)(this),!1);return c.length?(0,n.h)("div",{role:"none",class:[`${i}-flex`,p&&`${i}-flex--rtl`],style:{display:a?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:r,flexWrap:!u||e?"nowrap":"wrap",alignItems:l,gap:`${o.vertical}px ${o.horizontal}px`}},c):null}})}}]);