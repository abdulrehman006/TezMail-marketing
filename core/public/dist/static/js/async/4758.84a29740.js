"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["4758"],{22392(e,a,l){l.d(a,{$5:()=>u,Es:()=>x,KY:()=>f,Kr:()=>d,PV:()=>v,TA:()=>o,aV:()=>n,lZ:()=>m,nz:()=>b,p9:()=>p,pC:()=>g,rN:()=>h,tP:()=>s,xZ:()=>c,yT:()=>k,yu:()=>r});var t=l(85020);let{t:i}=l(46831).Ay.global,o=e=>t.K.get("/domains/list",{params:e}),n=()=>t.K.get("/domains/all"),s=()=>t.K.post("/multi_ip_domain/apply"),u=e=>t.K.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),r=e=>t.K.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),d=e=>t.K.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),p=e=>t.K.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),c=e=>t.K.get("/domains/get_ssl",{params:e}),m=e=>t.K.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),v=e=>t.K.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}}),f=e=>t.K.post("/domains/set_default_domain",e,{fetchOptions:{loading:i("domain.api.loading.settingDefault"),successMessage:!0}}),b=e=>t.K.post("/askai/project/create",e,{fetchOptions:{loading:i("domain.api.loading.settingBrandInfo"),successMessage:!0}}),h=e=>t.K.post("/multi_ip_domain/test",e,{fetchOptions:{loading:i("domain.api.loading.testingConnection"),successMessage:!0}}),g=()=>t.K.post("/askai/supplier/status"),x=e=>t.K.post("/domain_blocklist/check",e,{fetchOptions:{loading:i("domain.api.loading.detecting"),successMessage:!0}}),k=e=>t.K.get("/domain_blocklist/logs",{params:e})},28674(e,a,l){l.d(a,{DZ:()=>s,Ez:()=>u,Gt:()=>r,LN:()=>d,P5:()=>o,Se:()=>p,dz:()=>n});var t=l(85020);let{t:i}=l(46831).Ay.global,o=e=>t.K.get("/mailbox/list",{params:e}),n=e=>t.K.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),s=e=>t.K.post("/mailbox/batch_create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),u=e=>t.K.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),r=e=>t.K.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}}),d=e=>t.K.post("/mailbox/export",e,{responseType:"blob",fetchOptions:{loading:i("mailbox.api.loading.exporting"),successMessage:!0}}),p=e=>t.K.post("/mailbox/import",e,{fetchOptions:{loading:i("mailbox.api.loading.importing"),successMessage:!0}})},24646(e,a,l){l.d(a,{T:()=>n});var t=l(12532),i=l(97786),o=l(46831);let n=()=>{let{t:e}=o.Ay.global,{copy:a,isSupported:l,copied:n}=(0,i.iDZ)({legacy:!0});return{copied:n,copyText:async function(i){let o=!(arguments.length>1)||void 0===arguments[1]||arguments[1];i?l.value?(await a(i),o&&t.QB.success(e("common.useCopy.success"))):t.QB.error(e("common.useCopy.failed")):t.QB.error(e("common.useCopy.noText"))}}}},80111(e,a,l){l.d(a,{u:()=>n});var t=l(22720),i=l(12532),o=l(90290);let n=e=>{let{params:a,fetchFn:l,useParams:n,loading:s=!0,immediate:u=!0,rowKey:r=e=>e.id}=e,d=(0,o.KR)(s),p=(0,o.KR)([]),c=(0,o.KR)(0),m=(0,o.KR)(a),v=(0,o.KR)([]),f=(0,t.Q0)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(m.value.page=1),d.value=!0;try{let e=n?n(m.value):m.value,a=await l(e);(0,i.Gv)(a)&&(p.value=(0,i.cy)(a.list)?a.list:[],c.value=(0,i.Et)(a.total)?a.total:0)}finally{v.value=[],d.value=!1}},300),b=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return f(e)},h=e=>{m.value.page=e},g=e=>{m.value.page_size=e};return(0,o.sV)(()=>{u&&b()}),{tableData:p,tableTotal:c,tableKeys:v,tableParams:m,fetchTable:b,resetTable:()=>b(!0),tableProps:(0,o.EW)(()=>({rowKey:r,data:p.value,loading:d.value,checkedRowKeys:v.value,onUpdateCheckedRowKeys:e=>{v.value=e}})),batchProps:(0,o.EW)(()=>({rowKey:r,data:p.value,checkedRowKeys:v.value,onUpdateCheckedRowKeys:e=>{v.value=e}})),pageProps:(0,o.EW)(()=>({page:m.value.page,pageSize:m.value.page_size,itemCount:c.value,onUpdatePage:h,onUpdatePageSize:g}))}}},90216(e,a,l){l.d(a,{A:()=>o});var t=l(45449),i=l(90290);let o=(0,i.pM)({__name:"index",props:(0,i.zz)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,i.zz)(["search"],["update:value"]),setup(e,a){let{expose:l,emit:o}=a,n=(0,i.KR)(null),s=(0,i.fn)(e,"value"),u=()=>{o("search",s.value)};return l({focus:()=>{var e;null==(e=n.value)||e.focus()}}),(a,l)=>{let o=t.A;return(0,i.uX)(),(0,i.Wv)(o,(0,i.v6)({ref_key:"inputRef",ref:n,value:s.value,"onUpdate:value":l[0]||(l[0]=e=>s.value=e)},a.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,i.jR)(u,["enter"])}),(0,i.eX)({_:2},[e.prefix?{name:"prefix",fn:(0,i.k6)(()=>[(0,i.Lk)("div",{class:"flex items-center cursor-pointer",onClick:u},[...l[1]||(l[1]=[(0,i.Lk)("i",{class:"i-mdi-search text-16px"},null,-1)])])]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,i.k6)(()=>[(0,i.Lk)("div",{class:"flex items-center cursor-pointer",onClick:u},[...l[2]||(l[2]=[(0,i.Lk)("i",{class:"i-mdi-search text-16px"},null,-1)])])]),key:"1"}]),1040,["value","style"])}}})},91756(e,a,l){l.d(a,{A:()=>u});var t=l(27546),i=l(29207),o=l(90290);let n={class:"flex gap-10px"},s={class:"flex-center w-40px"},u=(0,o.pM)({__name:"index",props:{data:{type:Array,default:()=>[]},rowKey:{type:Function,required:!0},options:{type:Array,default:()=>[]},checkedRowKeys:{type:Array,default:()=>[]}},emits:["updateCheckedRowKeys","select"],setup(e,a){let{emit:l}=a,u=(0,o.EW)({get:()=>e.checkedRowKeys.length>0&&e.checkedRowKeys.length===e.data.length,set(a){l("updateCheckedRowKeys",a?e.data.map(a=>e.rowKey(a)):[])}}),r=(0,o.EW)(()=>0===e.data.length),d=(0,o.EW)(()=>e.checkedRowKeys.length>0&&e.checkedRowKeys.length<e.data.length),p=(0,o.EW)(()=>0===e.checkedRowKeys.length);return(a,c)=>{let m=i.A,v=t.Ay;return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",s,[(0,o.bF)(m,{checked:(0,o.R1)(u),"onUpdate:checked":c[0]||(c[0]=e=>(0,o.i9)(u)?u.value=e:null),disabled:(0,o.R1)(r),indeterminate:(0,o.R1)(d)},null,8,["checked","disabled","indeterminate"])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,a=>((0,o.uX)(),(0,o.Wv)(v,{key:a.value,disabled:(0,o.R1)(p)||a.disabled,onClick:t=>{l("select",a.value,e.checkedRowKeys)}},{default:(0,o.k6)(()=>[(0,o.eW)((0,o.v_)(a.label),1)]),_:2},1032,["disabled","onClick"]))),128))])}}})},28391(e,a,l){l.d(a,{A:()=>s});var t=l(23995),i=l(27546),o=l(90290);let n={class:"leading-22px text-13px text-desc text-center"},s=(0,o.pM)({__name:"index",setup(e){let a=()=>{window.open("https://github.com/aaPanel/BillionMail/issues")},l=()=>{window.open("https://github.com/aaPanel/BillionMail")};return(e,s)=>{let u=i.Ay,r=(0,o.g2)("i18n-t"),d=t.A;return(0,o.uX)(),(0,o.Wv)(d,null,{default:(0,o.k6)(()=>[(0,o.Lk)("div",n,[(0,o.bF)(r,{tag:"span",scope:"global",keypath:"components.tableHelp.text1"},{issues:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-13px",type:"primary",text:"",onClick:a},{default:(0,o.k6)(()=>[...s[0]||(s[0]=[(0,o.Lk)("span",null,"Issues",-1),(0,o.Lk)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])]),_:1})]),star:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-13px",type:"primary",text:"",onClick:l},{default:(0,o.k6)(()=>[...s[1]||(s[1]=[(0,o.eW)(" Star ",-1),(0,o.Lk)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])]),_:1})]),_:1}),s[2]||(s[2]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("span",null,(0,o.v_)(e.$t("components.tableHelp.text2")),1)])]),_:1})}}})},63919(e,a,l){l.d(a,{A:()=>o});var t=l(85684),i=l(90290);let o=(0,i.pM)({__name:"index",setup(e){let a=!!(0,i.Ht)().toolsLeft,l=!!(0,i.Ht)().toolsRight,o=!!(0,i.Ht)().pageLeft||!!(0,i.Ht)().pageRight;return(e,n)=>{let s=t.A;return(0,i.uX)(),(0,i.CE)("div",null,[a||l?((0,i.uX)(),(0,i.Wv)(s,{key:0,class:"items-center mb-12px",justify:"space-between"},{default:(0,i.k6)(()=>[(0,i.bF)(s,{class:"items-center",size:12},{default:(0,i.k6)(()=>[(0,i.RG)(e.$slots,"toolsLeft")]),_:3}),(0,i.bF)(s,{class:"items-center",size:12},{default:(0,i.k6)(()=>[(0,i.RG)(e.$slots,"toolsRight")]),_:3})]),_:3})):(0,i.Q3)("",!0),(0,i.RG)(e.$slots,"table"),(0,i.R1)(o)?((0,i.uX)(),(0,i.Wv)(s,{key:1,class:"items-center mt-12px",justify:"space-between"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[(0,i.RG)(e.$slots,"pageLeft")]),(0,i.bF)(s,null,{default:(0,i.k6)(()=>[(0,i.RG)(e.$slots,"pageRight")]),_:3})]),_:3})):(0,i.Q3)("",!0),(0,i.RG)(e.$slots,"modal")])}}})},23618(e,a,l){l.d(a,{A:()=>s});var t=l(24259),i=l(90290),o=l(12532);let n={class:"ml-8px text-14px"},s=(0,i.pM)({__name:"index",props:(0,i.zz)({storeKey:{default:""},pageSizes:{default:()=>[10,20,50,100]},showTotal:{type:Boolean,default:!0},showSizePicker:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0},onUpdatePage:{}},{page:{},pageModifiers:{},pageSize:{},pageSizeModifiers:{}}),emits:(0,i.zz)(["refresh"],["update:page","update:pageSize"]),setup(e,a){let{emit:l}=a,s=(0,i.EW)(()=>{let{storeKey:a}=e;return a?`${a}-page`:""}),u=(0,i.fn)(e,"page"),r=(0,i.fn)(e,"pageSize"),d=a=>{var t;null==(t=e.onUpdatePage)||t.call(e,a),l("refresh")},p=a=>{var t;u.value=1,null==(t=e.onUpdatePage)||t.call(e,1),c(a),l("refresh")},c=e=>{s.value&&(0,o.ZB)(s.value,String(e))};if(s.value){let e=(0,o.Lg)(s.value);e&&(r.value=(0,o.WZ)(e))}return(a,l)=>{let o=t.A;return(0,i.uX)(),(0,i.Wv)(o,(0,i.v6)(a.$attrs,{page:u.value,"onUpdate:page":[l[0]||(l[0]=e=>u.value=e),d],"page-size":r.value,"onUpdate:pageSize":[l[1]||(l[1]=e=>r.value=e),p],"show-size-picker":e.showSizePicker,"show-quick-jumper":e.showQuickJumper,"page-sizes":e.pageSizes,"display-order":["pages","size-picker","quick-jumper"]}),(0,i.eX)({_:2},[e.showTotal?{name:"suffix",fn:(0,i.k6)(e=>{let{itemCount:a}=e;return[(0,i.Lk)("span",n," Total "+(0,i.v_)(a),1)]}),key:"0"}:void 0]),1040,["page","page-size","show-size-picker","show-quick-jumper","page-sizes"])}}})},50449(e,a,l){l.r(a),l.d(a,{default:()=>j});var t=l(63919),i=l(23618),o=l(91756),n=l(77625),s=l(28391),u=l(90216),r=l(90290),d=l(27546),p=l(45679),c=l(85684),m=l(97786),v=l(12532),f=l(60045),b=l(24646),h=l(80111),g=l(28674),x=l(62606);let k={class:"flex"},_={class:"w-0 flex-1 flex items-center"},R={class:"min-w-0"},y=(0,r.pM)({__name:"index",props:{value:{default:""}},setup(e){let{copyText:a}=(0,b.T)(),l=(0,r.KR)(!1),t=(0,r.EW)(()=>l.value?e.value:"**********"),i=()=>{l.value=!l.value},o=async()=>{a(`${e.value}`)};return(e,a)=>{let n=x.Ay;return(0,r.uX)(),(0,r.CE)("div",k,[(0,r.Lk)("div",_,[(0,r.Lk)("div",R,[(0,r.bF)(n,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)((0,r.R1)(t)),1)]),_:1})]),(0,r.Lk)("div",{class:"ml-6px text-15px cursor-pointer",title:"Show",onClick:i},[(0,r.Lk)("i",{class:(0,r.C4)((0,r.R1)(l)?"i-mdi-eye-outline":"i-mdi-eye-off-outline")},null,2)]),(0,r.Lk)("div",{class:"reset ml-6px text-15px cursor-pointer text-#333",title:"Copy",onClick:o},[...a[0]||(a[0]=[(0,r.Lk)("i",{class:"i-mdi-content-copy"},null,-1)])])])])}}});var w=l(95403),A=l(22392),F=l(3401);let K=(0,r.pM)({__name:"DomainSelect",props:(0,r.zz)({isAll:{type:Boolean,default:!0}},{value:{default:()=>null},valueModifiers:{}}),emits:["update:value"],setup(e){let{t:a}=(0,F.s9)(),l=(0,r.fn)(e,"value"),t=(0,r.KR)(!1),i=(0,r.KR)([]);return(async()=>{try{t.value=!0;let o=await (0,A.aV)();(0,v.cy)(o)&&(i.value=o.map(e=>({label:e.domain,value:e.domain})),e.isAll?(i.value.unshift({label:a("common.all.text"),value:""}),l.value||(l.value="")):o.length>0&&!l.value&&(l.value=o[0].domain))}finally{t.value=!1}})(),(e,o)=>{let n=w.A;return(0,r.uX)(),(0,r.Wv)(n,{value:l.value,"onUpdate:value":o[0]||(o[0]=e=>l.value=e),loading:(0,r.R1)(t),filterable:!0,options:(0,r.R1)(i),placeholder:(0,r.R1)(a)("mailbox.domain.selectPlaceholder")},null,8,["value","loading","options","placeholder"])}}}),q=(0,l(64901).default)(K,[["__scopeId","data-v-3e5d2a71"]]);var C=l(13665),M=l(2770),z=l(60801),W=l(68275),E=l(45449);let L=(0,r.pM)({__name:"MailboxForm",setup(e){let{t:a}=(0,F.s9)(),l=(0,r.KR)(!1),t=(0,r.EW)(()=>l.value?a("mailbox.form.editTitle"):a("mailbox.form.addTitle")),i=(0,r.rk)("formRef"),o=(0,r.Kh)({quota:5,unit:"GB",isAdmin:0,quota_active:1,full_name:"",local_part:"",domain:null,password:(0,v.l8)(),active:1}),n=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],s=[{label:a("mailbox.userType.general"),value:0},{label:a("mailbox.userType.admin"),value:1}],u={full_name:{required:!0,trigger:"blur",validator:()=>""!==o.full_name.trim()||Error("Please enter name")},domain:{trigger:"blur",required:!0,validator:()=>""!==o.local_part.trim()&&!!o.domain||Error(a("mailbox.validation.emailRequired"))},password:{trigger:"blur",required:!0,validator:()=>{if(l.value){if(o.password&&o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(o.password&&!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}else{if(o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}return!0}}},d=e=>{o.full_name=e},[c,m]=(0,f.h)({onChangeState:e=>{if(e){let e=m.getState(),{row:a}=e;if(l.value=e.isEdit,a){o.full_name=a.full_name,o.local_part=a.local_part,o.domain=a.domain,o.isAdmin=a.is_admin,o.active=a.active,o.password=a.password,o.quota_active=a.quota_active;let[e,l]=(0,v.JB)(a.quota).split(" ");o.quota=(0,v.WZ)(e),o.unit=l}}else o.full_name="",o.local_part="",o.domain=null,o.password=(0,v.l8)(),o.quota=5,o.unit="GB",o.isAdmin=0,o.active=1,o.quota_active=1},onConfirm:async()=>{var e;await (null==(e=i.value)?void 0:e.validate());let a={full_name:o.full_name,local_part:o.local_part,domain:o.domain||"",password:o.password,quota:((e,a)=>{switch(a){case"GB":e*=1024;case"MB":e*=1048576}return e})(o.quota,o.unit),isAdmin:o.isAdmin,active:o.active,quota_active:o.quota_active};l.value?await (0,g.Ez)(a):await (0,g.dz)(a),m.getState().refresh()}});return(e,m)=>{let v=E.A,f=W.A,b=z.Ay,h=p.A,g=M.A,x=w.A,k=C.A;return(0,r.uX)(),(0,r.Wv)((0,r.R1)(c),{title:(0,r.R1)(t),width:"520"},{default:(0,r.k6)(()=>[(0,r.bF)(k,{ref_key:"formRef",ref:i,class:"pt-20px",model:(0,r.R1)(o),rules:u},{default:(0,r.k6)(()=>[(0,r.bF)(b,{label:(0,r.R1)(a)("mailbox.form.emailAddress"),path:"domain"},{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(v,{value:(0,r.R1)(o).local_part,"onUpdate:value":[m[0]||(m[0]=e=>(0,r.R1)(o).local_part=e),d],class:"flex-1",disabled:(0,r.R1)(l)},null,8,["value","disabled"]),(0,r.bF)(q,{value:(0,r.R1)(o).domain,"onUpdate:value":m[1]||(m[1]=e=>(0,r.R1)(o).domain=e),class:"flex-1","is-all":!1,disabled:(0,r.R1)(l)},null,8,["value","disabled"])]),_:1})]),_:1},8,["label"]),(0,r.bF)(b,{label:"Display Name",path:"full_name"},{default:(0,r.k6)(()=>[(0,r.bF)(v,{value:(0,r.R1)(o).full_name,"onUpdate:value":m[2]||(m[2]=e=>(0,r.R1)(o).full_name=e)},null,8,["value"])]),_:1}),(0,r.bF)(b,{label:(0,r.R1)(a)("mailbox.form.password"),path:"password"},{default:(0,r.k6)(()=>[(0,r.bF)(v,{value:(0,r.R1)(o).password,"onUpdate:value":m[3]||(m[3]=e=>(0,r.R1)(o).password=e),placeholder:(0,r.R1)(a)("mailbox.form.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,r.bF)(b,{label:"Quota limit"},{default:(0,r.k6)(()=>[(0,r.bF)(h,{value:(0,r.R1)(o).quota_active,"onUpdate:value":m[4]||(m[4]=e=>(0,r.R1)(o).quota_active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),(0,r.bF)(b,{label:(0,r.R1)(a)("mailbox.form.quota"),path:"quota"},{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(g,{value:(0,r.R1)(o).quota,"onUpdate:value":m[5]||(m[5]=e=>(0,r.R1)(o).quota=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"]),(0,r.bF)(x,{value:(0,r.R1)(o).unit,"onUpdate:value":m[6]||(m[6]=e=>(0,r.R1)(o).unit=e),class:"flex-1",options:n},null,8,["value"])]),_:1})]),_:1},8,["label"]),(0,r.bF)(b,{label:(0,r.R1)(a)("mailbox.form.userType"),path:"userType"},{default:(0,r.k6)(()=>[(0,r.bF)(x,{value:(0,r.R1)(o).isAdmin,"onUpdate:value":m[7]||(m[7]=e=>(0,r.R1)(o).isAdmin=e),options:s},null,8,["value"])]),_:1},8,["label"]),(0,r.bF)(b,{label:(0,r.R1)(a)("mailbox.form.status"),"show-feedback":!1},{default:(0,r.k6)(()=>[(0,r.bF)(h,{value:(0,r.R1)(o).active,"onUpdate:value":m[8]||(m[8]=e=>(0,r.R1)(o).active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}});var B=l(98179);let U=(0,r.pM)({__name:"MailboxBatchAdd",emits:["refresh"],setup(e,a){let{expose:l,emit:t}=a,{t:i}=(0,F.s9)(),o=(0,r.KR)(!1),n=(0,r.rk)("formRef"),s=(0,r.Kh)({domain:null,prefix:"",count:10,quota:5,unit:"GB",password:"",quota_active:1}),u={domain:{trigger:"change",required:!0,validator:()=>!!s.domain||Error(i("mailbox.validation.domainRequired"))},prefix:{trigger:"blur",required:!0,validator:()=>!(s.prefix.trim().length<1)||Error(i("mailbox.validation.prefixRequired"))},count:{trigger:"blur",required:!0,validator:()=>!(s.count<1)||Error(i("mailbox.validation.countRequired"))}},d=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],c=async()=>{var e;await (null==(e=n.value)?void 0:e.validate()),await (0,g.DZ)(m()),t("refresh")},m=()=>({domain:s.domain||"",quota:v(s.quota,s.unit),prefix:s.prefix,count:s.count,quota_active:s.quota_active}),v=(e,a)=>{switch(a){case"GB":e*=1024;case"MB":e*=1048576}return e};return l({open:()=>{s.domain=null,s.prefix="",s.count=10,s.quota=5,s.unit="GB",s.password="",s.quota_active=1,o.value=!0}}),(e,a)=>{let l=z.Ay,t=E.A,i=M.A,m=p.A,v=w.A,f=W.A,b=C.A,h=B.A;return(0,r.uX)(),(0,r.Wv)(h,{show:(0,r.R1)(o),"onUpdate:show":a[7]||(a[7]=e=>(0,r.i9)(o)?o.value=e:null),title:e.$t("mailbox.form.batchAddTitle"),width:500,onConfirm:c},{default:(0,r.k6)(()=>[(0,r.bF)(b,{ref_key:"formRef",ref:n,class:"pt-8px",model:(0,r.R1)(s),rules:u},{default:(0,r.k6)(()=>[(0,r.bF)(l,{label:e.$t("mailbox.form.domain"),path:"domain"},{default:(0,r.k6)(()=>[(0,r.bF)(q,{value:(0,r.R1)(s).domain,"onUpdate:value":a[0]||(a[0]=e=>(0,r.R1)(s).domain=e),class:"flex-1","is-all":!1,disabled:!1},null,8,["value"])]),_:1},8,["label"]),(0,r.bF)(l,{label:e.$t("mailbox.form.prefix"),path:"prefix"},{default:(0,r.k6)(()=>[(0,r.bF)(t,{value:(0,r.R1)(s).prefix,"onUpdate:value":a[1]||(a[1]=e=>(0,r.R1)(s).prefix=e)},null,8,["value"])]),_:1},8,["label"]),(0,r.bF)(l,{label:e.$t("mailbox.form.count"),path:"count"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{value:(0,r.R1)(s).count,"onUpdate:value":a[2]||(a[2]=e=>(0,r.R1)(s).count=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"])]),_:1},8,["label"]),(0,r.Q3)("",!0),(0,r.bF)(l,{label:"Quota limit"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{value:(0,r.R1)(s).quota_active,"onUpdate:value":a[4]||(a[4]=e=>(0,r.R1)(s).quota_active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),(0,r.bF)(l,{label:e.$t("mailbox.form.quota"),path:"quota"},{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(i,{value:(0,r.R1)(s).quota,"onUpdate:value":a[5]||(a[5]=e=>(0,r.R1)(s).quota=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"]),(0,r.bF)(v,{value:(0,r.R1)(s).unit,"onUpdate:value":a[6]||(a[6]=e=>(0,r.R1)(s).unit=e),class:"flex-1",options:d},null,8,["value"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["show","title"])}}});var T=l(60319);let S={class:"py-16px"},$=(0,r.pM)({__name:"MailboxImport",emits:["refresh"],setup(e,a){let{expose:l,emit:t}=a,{t:i}=(0,F.s9)(),o=(0,r.KR)(!1),n=(0,r.Kh)({file_data:"",file_type:""}),s=e=>{let a=new FileReader;a.onload=a=>{var l;n.file_type=e.name.substring(e.name.lastIndexOf(".")+1),n.file_data=null==(l=a.target)?void 0:l.result},e.file&&a.readAsText(e.file)},u=async()=>{if(!n.file_data||!n.file_type)return v.QB.error(i("mailbox.validation.fileRequired")),!1;await (0,g.Se)((0,r.ux)(n)),t("refresh")};return l({open:()=>{n.file_data="",n.file_type="",o.value=!0}}),(e,a)=>{let l=T.A,t=B.A;return(0,r.uX)(),(0,r.Wv)(t,{show:(0,r.R1)(o),"onUpdate:show":a[0]||(a[0]=e=>(0,r.i9)(o)?o.value=e:null),title:e.$t("mailbox.form.importTitle"),width:480,onConfirm:u},{default:(0,r.k6)(()=>[(0,r.Lk)("div",S,[(0,r.bF)(l,{"is-upload":!1,accept:["csv"],onChange:s})])]),_:1},8,["show","title"])}}}),G=(0,r.pM)({__name:"MailboxExport",setup(e,a){let{expose:l}=a,t=(0,r.KR)(!1),i=(0,r.Kh)({domain:null,format:"csv"}),o=[{label:"CSV",value:"csv"},{label:"TXT",value:"txt"}],n=async()=>{await (0,g.LN)({domain:i.domain||"",file_type:i.format})};return l({open:e=>{i.domain=e||null,i.format="csv",t.value=!0}}),(e,a)=>{let l=z.Ay,s=w.A,u=C.A,d=B.A;return(0,r.uX)(),(0,r.Wv)(d,{show:(0,r.R1)(t),"onUpdate:show":a[2]||(a[2]=e=>(0,r.i9)(t)?t.value=e:null),title:e.$t("mailbox.form.exportTitle"),width:480,onConfirm:n},{default:(0,r.k6)(()=>[(0,r.bF)(u,{class:"pt-8px"},{default:(0,r.k6)(()=>[(0,r.bF)(l,{label:e.$t("mailbox.form.domain")},{default:(0,r.k6)(()=>[(0,r.bF)(q,{value:(0,r.R1)(i).domain,"onUpdate:value":a[0]||(a[0]=e=>(0,r.R1)(i).domain=e)},null,8,["value"])]),_:1},8,["label"]),(0,r.bF)(l,{label:"Format"},{default:(0,r.k6)(()=>[(0,r.bF)(s,{value:(0,r.R1)(i).format,"onUpdate:value":a[1]||(a[1]=e=>(0,r.R1)(i).format=e),options:o},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show","title"])}}}),O={class:"p-24px"},X={class:"bt-title"},P={class:"w-220px"};function Q(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,r.vv)(e)}let j=(0,r.pM)({__name:"index",setup(e){let a=(0,m.ZDG)(),{t:l}=(0,F.s9)(),{copyText:x}=(0,b.T)(),k=(0,r.rk)("batchAddRef"),_=()=>{var e;null==(e=k.value)||e.open()},R=(0,r.rk)("importRef"),w=()=>{var e;null==(e=R.value)||e.open()},A=(0,r.rk)("exportRef"),K=()=>{var e;null==(e=A.value)||e.open(C.value.domain)},{tableParams:C,tableProps:M,pageProps:z,batchProps:W,fetchTable:E,resetTable:B}=(0,h.u)({loading:!0,immediate:!0,params:{page:1,page_size:10,domain:a.value.state.domain||"",keyword:""},rowKey:e=>e.username,fetchFn:g.P5}),T=(0,r.KR)([{type:"selection",width:40},{key:"username",title:l("mailbox.columns.username"),width:"14%",minWidth:120,ellipsis:{tooltip:!0}},{key:"password",title:l("mailbox.columns.password"),width:"16%",minWidth:140,render:e=>(0,r.bF)(y,{value:e.password||"--"},null)},{key:"login",title:l("mailbox.columns.loginInfo"),ellipsis:{tooltip:!0},minWidth:140,render:e=>{let a;return(0,r.bF)("div",{class:"flex justify-center w-160px"},[(0,r.bF)(d.Ay,{text:!0,type:"primary",onClick:()=>{x(l("mailbox.loginInfo.template",{webmail:window.location.origin+"/roundcube",username:e.username,password:e.password,mx:e.mx}))}},Q(a=l("common.actions.copy"))?a:{default:()=>[a]})])}},{key:"quota",title:l("mailbox.columns.quota"),width:"18%",minWidth:160,render:e=>1===e.quota_active?`${(0,v.JB)(e.used_quota)} / ${(0,v.JB)(e.quota)}`:(0,r.bF)("i",{class:"i-common:quota w-20px h-20px"},null)},{key:"is_admin",title:l("mailbox.columns.type"),width:"12%",minWidth:100,render:e=>1===e.is_admin?l("mailbox.userType.admin"):l("mailbox.userType.general")},{key:"status",title:l("mailbox.columns.status"),width:"10%",minWidth:80,render:e=>(0,r.bF)(p.A,{value:e.active,"checked-value":1,"unchecked-value":0,size:"small",onUpdateValue:a=>{D(e,a)}},null)},{title:l("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let a,t;return(0,r.bF)(c.A,{inline:!0},{default:()=>[(0,r.bF)(d.Ay,{type:"primary",text:!0,onClick:()=>{I(e)}},Q(a=l("common.actions.edit"))?a:{default:()=>[a]}),(0,r.bF)(d.Ay,{type:"error",text:!0,onClick:()=>{J(e)}},Q(t=l("common.actions.delete"))?t:{default:()=>[t]})]})}}]),[S,j]=(0,f.h)({component:L,state:{isEdit:!1,refresh:E}}),Z=()=>{j.setState({isEdit:!1,row:null}),j.open()},D=async(e,a)=>{await (0,g.Ez)({full_name:e.full_name,domain:e.domain,password:e.password,quota:e.quota,isAdmin:e.is_admin,active:a}),e.active=a},I=e=>{j.setState({isEdit:!0,row:e}),j.open()},J=e=>{(0,v.lJ)({title:l("mailbox.delete.title"),content:l("mailbox.delete.confirm",{name:e.username}),confirmText:l("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,g.Gt)({emails:[e.username]}),E()}})},H=[{label:l("common.actions.delete"),value:"delete"}],V=(e,a)=>{"delete"===e&&N(a)},N=e=>{(0,v.lJ)({title:l("mailbox.actions.batchDelete"),content:l("mailbox.delete.batchConfirm",{count:e.length}),confirmText:l("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,g.Gt)({emails:e}),E()}})};return(e,a)=>{let p=u.A,c=s.A,m=n.A,v=o.A,f=i.A,b=t.A;return(0,r.uX)(),(0,r.CE)("div",O,[(0,r.Lk)("div",X,(0,r.v_)((0,r.R1)(l)("layout.menu.mailboxes")),1),(0,r.bF)(b,null,{toolsLeft:(0,r.k6)(()=>[(0,r.bF)((0,r.R1)(d.Ay),{type:"primary",onClick:Z},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)((0,r.R1)(l)("mailbox.actions.add")),1)]),_:1}),(0,r.bF)((0,r.R1)(d.Ay),{onClick:_},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)(e.$t("mailbox.actions.batchAdd")),1)]),_:1}),(0,r.bF)((0,r.R1)(d.Ay),{onClick:w},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)(e.$t("common.actions.import")),1)]),_:1}),(0,r.bF)((0,r.R1)(d.Ay),{onClick:K},{default:(0,r.k6)(()=>[(0,r.eW)((0,r.v_)((0,r.R1)(l)("mailbox.actions.exportAll")),1)]),_:1})]),toolsRight:(0,r.k6)(()=>[(0,r.Lk)("div",P,[(0,r.bF)(q,{value:(0,r.R1)(C).domain,"onUpdate:value":[a[0]||(a[0]=e=>(0,r.R1)(C).domain=e),a[1]||(a[1]=()=>(0,r.R1)(B)())]},null,8,["value"])]),(0,r.bF)(p,{value:(0,r.R1)(C).keyword,"onUpdate:value":a[2]||(a[2]=e=>(0,r.R1)(C).keyword=e),width:280,placeholder:(0,r.R1)(l)("mailbox.search.usernamePlaceholder"),onSearch:a[3]||(a[3]=()=>(0,r.R1)(B)())},null,8,["value","placeholder"])]),table:(0,r.k6)(()=>[(0,r.bF)(m,(0,r.v6)((0,r.R1)(M),{columns:(0,r.R1)(T)}),{empty:(0,r.k6)(()=>[(0,r.bF)(c)]),_:1},16,["columns"])]),pageLeft:(0,r.k6)(()=>[(0,r.bF)(v,(0,r.v6)((0,r.R1)(W),{options:H,onSelect:V}),null,16)]),pageRight:(0,r.k6)(()=>[(0,r.bF)(f,(0,r.v6)((0,r.R1)(z),{onRefresh:(0,r.R1)(E)}),null,16,["onRefresh"])]),modal:(0,r.k6)(()=>[(0,r.bF)((0,r.R1)(S)),(0,r.bF)(U,{ref_key:"batchAddRef",ref:k,onRefresh:(0,r.R1)(E)},null,8,["onRefresh"]),(0,r.bF)($,{ref_key:"importRef",ref:R,onRefresh:(0,r.R1)(E)},null,8,["onRefresh"]),(0,r.bF)(G,{ref_key:"exportRef",ref:A},null,512)]),_:1})])}}})}}]);