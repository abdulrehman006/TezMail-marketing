"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["1662"],{44301(e,t,a){a.d(t,{CI:()=>d,I7:()=>m,UT:()=>r,mn:()=>p,n5:()=>o,tY:()=>u,ub:()=>s});var l=a(46831),n=a(85020);let{t:i}=l.Ay.global;function o(e){return n.K.get("/email_template/list",{params:e})}function r(){return n.K.get("/email_template/all")}function u(e){return n.K.get("/email_template/get",{params:e})}function p(e){return n.K.post("/email_template/create",e,{fetchOptions:{loading:i("market.template.loading.creating"),successMessage:!0}})}function s(e){return n.K.post("/email_template/update",e,{fetchOptions:{loading:i("market.template.loading.updating"),successMessage:!0}})}function d(e){return n.K.post("/email_template/copy",e,{fetchOptions:{loading:i("market.template.loading.copying"),successMessage:!0}})}function m(e){return n.K.post("/email_template/delete",e,{fetchOptions:{loading:i("market.template.loading.deleting"),successMessage:!0}})}},6943(e,t,a){a.d(t,{i:()=>o});var l=a(21879),n=a(12532),i=a(90290);let o=e=>{let{fetchFn:t,params:a,loading:o=!1,immediate:r=!1}=e,u=(0,i.KR)(o),p=(0,i.KR)([]),s=(0,i.KR)(0),d=(0,i.KR)(a),m=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e&&(a.page=1),t){u.value=!0;try{let e=await t(d.value);(0,n.Gv)(e)&&(p.value=(0,n.cy)(e.list)?e.list:[],s.value=(0,l.A)(e.total)?e.total:0)}finally{u.value=!1}}};return r&&m(),{loading:u,tableList:p,tableTotal:s,tableParams:d,getTableData:m}}},22041(e,t,a){a.d(t,{A:()=>r});var l=a(76628),n=a(90290),i=a(5487);let o=(0,n.pM)({__name:"index",props:(0,n.zz)({language:{type:String,default:"html"},theme:{type:String,default:"vs-dark"},options:{type:Object,default:()=>({})}},{value:{default:""},valueModifiers:{}}),emits:(0,n.zz)(["save"],["update:value"]),setup(e,t){let{expose:a,emit:o}=t,r=(0,n.fn)(e,"value"),u=(0,n.KR)(null),p=null,s=(0,n.KR)(!1),d=async()=>{if(u.value&&!p)try{s.value=!0;let t=await i.A.init();(p=t.editor.create(u.value,{value:r.value,language:e.language,theme:e.theme,minimap:{enabled:!1},automaticLayout:!0,scrollBeyondLastLine:!1,fontSize:14,tabSize:2,wordWrap:"on",...e.options})).onDidChangeModelContent(()=>{r.value=(null==p?void 0:p.getValue())||""}),p.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyS,function(){o("save")})}finally{s.value=!1}};return(0,n.wB)(()=>r.value,e=>{p&&e!==p.getValue()&&p.setValue(e)}),(0,n.sV)(()=>{d()}),(0,n.xo)(()=>{p&&(p.dispose(),p=null)}),a({getEditor:()=>p}),(e,t)=>{let a=l.A;return(0,n.uX)(),(0,n.Wv)(a,{class:"h-full",show:(0,n.R1)(s)},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{ref_key:"containerRef",ref:u,class:"monaco-editor-container"},null,512)]),_:1},8,["show"])}}}),r=(0,a(64901).default)(o,[["__scopeId","data-v-87023034"]])},45935(e,t,a){a.d(t,{A:()=>i});var l=a(90290);let n=["height","srcdoc"],i=(0,l.pM)({__name:"index",props:{value:{type:String,default:""},height:{type:[String,Number],default:"100%"}},setup:e=>(t,a)=>((0,l.uX)(),(0,l.CE)("iframe",{width:"100%",height:e.height,srcdoc:e.value,style:{border:"none",borderRadius:"4px"}},null,8,n))})},90216(e,t,a){a.d(t,{A:()=>i});var l=a(45449),n=a(90290);let i=(0,n.pM)({__name:"index",props:(0,n.zz)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,n.zz)(["search"],["update:value"]),setup(e,t){let{expose:a,emit:i}=t,o=(0,n.KR)(null),r=(0,n.fn)(e,"value"),u=()=>{i("search",r.value)};return a({focus:()=>{var e;null==(e=o.value)||e.focus()}}),(t,a)=>{let i=l.A;return(0,n.uX)(),(0,n.Wv)(i,(0,n.v6)({ref_key:"inputRef",ref:o,value:r.value,"onUpdate:value":a[0]||(a[0]=e=>r.value=e)},t.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,n.jR)(u,["enter"])}),(0,n.eX)({_:2},[e.prefix?{name:"prefix",fn:(0,n.k6)(()=>[(0,n.Lk)("div",{class:"flex items-center cursor-pointer",onClick:u},[...a[1]||(a[1]=[(0,n.Lk)("i",{class:"i-mdi-search text-16px"},null,-1)])])]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,n.k6)(()=>[(0,n.Lk)("div",{class:"flex items-center cursor-pointer",onClick:u},[...a[2]||(a[2]=[(0,n.Lk)("i",{class:"i-mdi-search text-16px"},null,-1)])])]),key:"1"}]),1040,["value","style"])}}})},28391(e,t,a){a.d(t,{A:()=>r});var l=a(23995),n=a(27546),i=a(90290);let o={class:"leading-22px text-13px text-desc text-center"},r=(0,i.pM)({__name:"index",setup(e){let t=()=>{window.open("https://github.com/aaPanel/BillionMail/issues")},a=()=>{window.open("https://github.com/aaPanel/BillionMail")};return(e,r)=>{let u=n.Ay,p=(0,i.g2)("i18n-t"),s=l.A;return(0,i.uX)(),(0,i.Wv)(s,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",o,[(0,i.bF)(p,{tag:"span",scope:"global",keypath:"components.tableHelp.text1"},{issues:(0,i.k6)(()=>[(0,i.bF)(u,{class:"text-13px",type:"primary",text:"",onClick:t},{default:(0,i.k6)(()=>[...r[0]||(r[0]=[(0,i.Lk)("span",null,"Issues",-1),(0,i.Lk)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])]),_:1})]),star:(0,i.k6)(()=>[(0,i.bF)(u,{class:"text-13px",type:"primary",text:"",onClick:a},{default:(0,i.k6)(()=>[...r[1]||(r[1]=[(0,i.eW)(" Star ",-1),(0,i.Lk)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])]),_:1})]),_:1}),r[2]||(r[2]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("span",null,(0,i.v_)(e.$t("components.tableHelp.text2")),1)])]),_:1})}}})},63919(e,t,a){a.d(t,{A:()=>i});var l=a(85684),n=a(90290);let i=(0,n.pM)({__name:"index",setup(e){let t=!!(0,n.Ht)().toolsLeft,a=!!(0,n.Ht)().toolsRight,i=!!(0,n.Ht)().pageLeft||!!(0,n.Ht)().pageRight;return(e,o)=>{let r=l.A;return(0,n.uX)(),(0,n.CE)("div",null,[t||a?((0,n.uX)(),(0,n.Wv)(r,{key:0,class:"items-center mb-12px",justify:"space-between"},{default:(0,n.k6)(()=>[(0,n.bF)(r,{class:"items-center",size:12},{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"toolsLeft")]),_:3}),(0,n.bF)(r,{class:"items-center",size:12},{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"toolsRight")]),_:3})]),_:3})):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"table"),(0,n.R1)(i)?((0,n.uX)(),(0,n.Wv)(r,{key:1,class:"items-center mt-12px",justify:"space-between"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",null,[(0,n.RG)(e.$slots,"pageLeft")]),(0,n.bF)(r,null,{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"pageRight")]),_:3})]),_:3})):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"modal")])}}})},23618(e,t,a){a.d(t,{A:()=>r});var l=a(24259),n=a(90290),i=a(12532);let o={class:"ml-8px text-14px"},r=(0,n.pM)({__name:"index",props:(0,n.zz)({storeKey:{default:""},pageSizes:{default:()=>[10,20,50,100]},showTotal:{type:Boolean,default:!0},showSizePicker:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0},onUpdatePage:{}},{page:{},pageModifiers:{},pageSize:{},pageSizeModifiers:{}}),emits:(0,n.zz)(["refresh"],["update:page","update:pageSize"]),setup(e,t){let{emit:a}=t,r=(0,n.EW)(()=>{let{storeKey:t}=e;return t?`${t}-page`:""}),u=(0,n.fn)(e,"page"),p=(0,n.fn)(e,"pageSize"),s=t=>{var l;null==(l=e.onUpdatePage)||l.call(e,t),a("refresh")},d=t=>{var l;u.value=1,null==(l=e.onUpdatePage)||l.call(e,1),m(t),a("refresh")},m=e=>{r.value&&(0,i.ZB)(r.value,String(e))};if(r.value){let e=(0,i.Lg)(r.value);e&&(p.value=(0,i.WZ)(e))}return(t,a)=>{let i=l.A;return(0,n.uX)(),(0,n.Wv)(i,(0,n.v6)(t.$attrs,{page:u.value,"onUpdate:page":[a[0]||(a[0]=e=>u.value=e),s],"page-size":p.value,"onUpdate:pageSize":[a[1]||(a[1]=e=>p.value=e),d],"show-size-picker":e.showSizePicker,"show-quick-jumper":e.showQuickJumper,"page-sizes":e.pageSizes,"display-order":["pages","size-picker","quick-jumper"]}),(0,n.eX)({_:2},[e.showTotal?{name:"suffix",fn:(0,n.k6)(e=>{let{itemCount:t}=e;return[(0,n.Lk)("span",o," Total "+(0,n.v_)(t),1)]}),key:"0"}:void 0]),1040,["page","page-size","show-size-picker","show-quick-jumper","page-sizes"])}}})},50272(e,t,a){a.d(t,{A:()=>o});var l=a(45935),n=a(90290),i=a(60045);let o=(0,n.pM)({__name:"TemplatePreview",setup(e){let t=(0,n.KR)(""),[a,o]=(0,i.h)({onChangeState:e=>{e&&(t.value=o.getState().html||"")}});return(e,i)=>{let o=l.A;return(0,n.uX)(),(0,n.Wv)((0,n.R1)(a),{title:e.$t("market.template.preview.title"),width:"820",footer:!1},{default:(0,n.k6)(()=>[(0,n.bF)(o,{height:580,value:(0,n.R1)(t)},null,8,["value"])]),_:1},8,["title"])}}})},6985(e,t,a){a.r(t),a.d(t,{default:()=>W});var l=a(63919),n=a(23618),i=a(77625),o=a(28391),r=a(90216),u=a(90290),p=a(27546),s=a(23254),d=a(85684),m=a(60045),c=a(6943),f=a(12532),v=a(44301),g=a(13665),h=a(60801),y=a(22041),k=a(60319),_=a(91664),b=a(95403),R=a(10932),x=a(45449);let w={class:"flex flex-col flex-1 h-580px"},A={class:"flex justify-end gap-12px mb-8px"},z={class:"flex-1 overflow-hidden"},F=(0,u.pM)({__name:"TemplateForm",setup(e){let t=(0,u.$V)(()=>Promise.all([a.e("7647"),a.e("7381"),a.e("7611"),a.e("4440"),a.e("2895")]).then(a.bind(a,44704))),l=(0,u.KR)(!1),n=(0,u.EW)(()=>l.value?"Edit template":"New template"),i=(0,u.KR)(0),o=(0,u.Kh)({temp_name:"",add_type:0,html_content:"",drag_data:""}),r=[{label:"HTML",value:0},{label:"Drag",value:1}],s=(0,u.EW)(()=>{var e;return(null==(e=r.find(e=>e.value===o.add_type))?void 0:e.label)||""}),d=e=>{let t=new FileReader;t.onload=e=>{var t;o.html_content=null==(t=e.target)?void 0:t.result},e.file&&t.readAsText(e.file)},c=()=>{let e=F.getState();e.preview&&e.preview(o.html_content)},[f,F]=(0,m.h)({onChangeState:e=>{if(e){let e=F.getState(),{row:t}=e;l.value=e.isEdit,t&&(i.value=t.id,o.temp_name=t.temp_name,o.add_type=t.add_type,o.html_content=t.html_content,o.drag_data=t.drag_data)}else i.value=0,o.temp_name="",o.add_type=0,o.html_content="",o.drag_data=""},onConfirm:async()=>{l.value?await (0,v.ub)({id:i.value,...(0,u.ux)(o)}):await (0,v.mn)((0,u.ux)(o)),F.getState().refresh()}});return(e,a)=>{let i=x.A,m=R.Ay,v=b.A,F=_.A,S=k.A,C=p.Ay,L=y.A,K=h.Ay,W=g.A;return(0,u.uX)(),(0,u.Wv)((0,u.R1)(f),{title:(0,u.R1)(n),width:1200},{default:(0,u.k6)(()=>[(0,u.bF)(W,{class:"pt-8px",model:(0,u.R1)(o)},{default:(0,u.k6)(()=>[(0,u.bF)(F,{cols:24,"x-gap":24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{span:18,label:"Name",path:"temp_name"},{default:(0,u.k6)(()=>[(0,u.bF)(i,{value:(0,u.R1)(o).temp_name,"onUpdate:value":a[0]||(a[0]=e=>(0,u.R1)(o).temp_name=e),placeholder:e.$t("market.template.add.namePlaceholder")},null,8,["value","placeholder"])]),_:1}),(0,u.bF)(m,{span:6,label:"Type",path:"add_type"},{default:(0,u.k6)(()=>[(0,u.bF)(v,{value:(0,u.R1)(o).add_type,"onUpdate:value":a[1]||(a[1]=e=>(0,u.R1)(o).add_type=e),disabled:(0,u.R1)(l),options:r},null,8,["value","disabled"])]),_:1})]),_:1}),(0,u.bF)(K,{label:(0,u.R1)(s),"show-feedback":!1},{default:(0,u.k6)(()=>[(0,u.Lk)("div",w,[(0,u.Lk)("div",A,[(0,u.Lk)("div",null,[(0,u.bF)(S,{mode:"button","button-type":"primary","is-upload":!1,accept:["html"],onChange:d},{default:(0,u.k6)(()=>[(0,u.eW)((0,u.v_)(e.$t("market.template.uploadHtml")),1)]),_:1})]),(0,u.bF)(C,{type:"primary",ghost:"",onClick:c},{default:(0,u.k6)(()=>[(0,u.eW)((0,u.v_)(e.$t("common.actions.preview")),1)]),_:1})]),(0,u.Lk)("div",z,[1===(0,u.R1)(o).add_type?((0,u.uX)(),(0,u.Wv)((0,u.R1)(t),{key:0,config:(0,u.R1)(o).drag_data,"onUpdate:config":a[2]||(a[2]=e=>(0,u.R1)(o).drag_data=e),html:(0,u.R1)(o).html_content,"onUpdate:html":a[3]||(a[3]=e=>(0,u.R1)(o).html_content=e)},null,8,["config","html"])):(0,u.Q3)("",!0),0===(0,u.R1)(o).add_type?((0,u.uX)(),(0,u.Wv)(L,{key:1,value:(0,u.R1)(o).html_content,"onUpdate:value":a[4]||(a[4]=e=>(0,u.R1)(o).html_content=e),language:"html"},null,8,["value"])):(0,u.Q3)("",!0)])])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}});var S=a(50272),C=a(3401);function L(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,u.vv)(e)}let K=(0,u.pM)({__name:"index",setup(e){let{t}=(0,C.s9)(),{tableParams:a,tableList:g,loading:h,tableTotal:y,getTableData:k}=(0,c.i)({loading:!0,immediate:!0,params:{page:1,page_size:10,keyword:""},fetchFn:v.n5}),_=(0,u.KR)([{key:"temp_name",title:t("market.template.columns.name"),minWidth:120,ellipsis:{tooltip:!0},render:e=>(0,u.bF)(p.Ay,{type:"primary",text:!0,onClick:()=>{w(e)}},{default:()=>[e.temp_name]})},{key:"add_type",title:"Type",minWidth:140,render:e=>1===e.add_type?(0,u.bF)(s.Ay,{size:"small",bordered:!1,type:"primary"},{default:()=>[(0,u.eW)("Drag")]}):0===e.add_type?(0,u.bF)(s.Ay,{size:"small",bordered:!1,type:"info"},{default:()=>[(0,u.eW)("HTML")]}):void 0},{key:"create_time",title:t("market.template.columns.createdAt"),minWidth:140,render:e=>(0,f.fU)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:240,render:e=>{let a,l,n,i;return(0,u.bF)(d.A,{inline:!0},{default:()=>[(0,u.bF)(p.Ay,{type:"primary",text:!0,onClick:()=>{K(e.html_content)}},L(a=t("common.actions.preview"))?a:{default:()=>[a]}),(0,u.bF)(p.Ay,{type:"primary",text:!0,onClick:()=>{w(e)}},L(l=t("common.actions.edit"))?l:{default:()=>[l]}),(0,u.bF)(p.Ay,{type:"primary",text:!0,onClick:()=>{W(e)}},L(n=t("market.template.actions.duplicate"))?n:{default:()=>[n]}),(0,u.bF)(p.Ay,{type:"error",text:!0,onClick:()=>{M(e)}},L(i=t("common.actions.delete"))?i:{default:()=>[i]})]})}}]),[b,R]=(0,m.h)({component:F,state:{isEdit:!1,refresh:k,preview:e=>{K(e)}}}),x=()=>{R.setState({isEdit:!1,row:null}),R.open()},w=e=>{R.setState({isEdit:!0,row:e}),R.open()},[A,z]=(0,m.h)({component:S.A}),K=e=>{z.setState({html:e}),z.open()},W=async e=>{await (0,v.CI)({id:e.id}),k()},M=e=>{(0,f.lJ)({title:t("market.template.delete.title"),content:t("market.template.delete.confirm",{name:e.temp_name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,v.I7)({id:e.id}),k()}})};return(e,s)=>{let d=r.A,m=o.A,c=i.A,f=n.A,v=l.A;return(0,u.uX)(),(0,u.CE)("div",null,[(0,u.bF)(v,null,{toolsLeft:(0,u.k6)(()=>[(0,u.bF)((0,u.R1)(p.Ay),{type:"primary",onClick:x},{default:(0,u.k6)(()=>[(0,u.eW)((0,u.v_)((0,u.R1)(t)("market.template.actions.add")),1)]),_:1})]),toolsRight:(0,u.k6)(()=>[(0,u.bF)(d,{value:(0,u.R1)(a).keyword,"onUpdate:value":s[0]||(s[0]=e=>(0,u.R1)(a).keyword=e),width:240,placeholder:(0,u.R1)(t)("market.template.search.namePlaceholder"),onSearch:s[1]||(s[1]=()=>(0,u.R1)(k)(!0))},null,8,["value","placeholder"])]),table:(0,u.k6)(()=>[(0,u.bF)(c,{loading:(0,u.R1)(h),columns:(0,u.R1)(_),data:(0,u.R1)(g)},{empty:(0,u.k6)(()=>[(0,u.bF)(m)]),_:1},8,["loading","columns","data"])]),pageRight:(0,u.k6)(()=>[(0,u.bF)(f,{page:(0,u.R1)(a).page,"onUpdate:page":s[2]||(s[2]=e=>(0,u.R1)(a).page=e),"page-size":(0,u.R1)(a).page_size,"onUpdate:pageSize":s[3]||(s[3]=e=>(0,u.R1)(a).page_size=e),"item-count":(0,u.R1)(y),onRefresh:(0,u.R1)(k)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,u.k6)(()=>[(0,u.bF)((0,u.R1)(b)),(0,u.bF)((0,u.R1)(A))]),_:1})])}}}),W=(0,a(64901).default)(K,[["__scopeId","data-v-20e9a29b"]])}}]);