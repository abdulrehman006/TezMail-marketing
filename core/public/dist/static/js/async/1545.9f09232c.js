"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["1545"],{3733(e,t,a){a.d(t,{GV:()=>c,JT:()=>m,Ni:()=>p,d2:()=>s,e:()=>g,oq:()=>o,q3:()=>r,qD:()=>d,vW:()=>u,wj:()=>i});var l=a(85020);let{t:n}=a(46831).Ru.global,o=e=>l.K.get("/contact/group/list",{params:e}),s=()=>l.K.get("/contact/group/all"),r=e=>l.K.get("/contact/group/info",{params:e}),i=e=>l.K.post("/contact/group/create",e,{fetchOptions:{loading:n("contacts.group.loading.createGroup"),successMessage:!0}}),u=e=>l.K.post("/contact/group/update",e,{fetchOptions:{loading:n("contacts.group.loading.updateGroup"),successMessage:!0}}),p=e=>l.K.post("/contact/group/delete",e,{fetchOptions:{loading:n("contacts.group.loading.deleteGroup"),successMessage:!0}}),c=e=>l.K.post("/contact/group/tag_contact_count",e),d=e=>l.K.post("/contact/group/export",e,{responseType:"blob",fetchOptions:{loading:n("contacts.group.loading.exportGroup"),successMessage:!0}}),g=e=>l.K.post("/contact/group/update",e,{fetchOptions:{loading:n("contacts.group.loading.saveSettings"),successMessage:!0}}),m=e=>l.K.post("/contact/group/update_unsubscribe",e,{fetchOptions:{loading:n("contacts.group.loading.saveSettings"),successMessage:!0}})},80111(e,t,a){a.d(t,{u:()=>s});var l=a(22720),n=a(12532),o=a(90290);let s=e=>{let{params:t,fetchFn:a,useParams:s,loading:r=!0,immediate:i=!0,rowKey:u=e=>e.id}=e,p=(0,o.KR)(r),c=(0,o.KR)([]),d=(0,o.KR)(0),g=(0,o.KR)(t),m=(0,o.KR)([]),f=(0,l.Q0)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(g.value.page=1),p.value=!0;try{let e=s?s(g.value):g.value,t=await a(e);(0,n.Gv)(t)&&(c.value=(0,n.cy)(t.list)?t.list:[],d.value=(0,n.Et)(t.total)?t.total:0)}finally{m.value=[],p.value=!1}},300),v=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return f(e)},h=e=>{g.value.page=e},y=e=>{g.value.page_size=e};return(0,o.sV)(()=>{i&&v()}),{tableData:c,tableTotal:d,tableKeys:m,tableParams:g,fetchTable:v,resetTable:()=>v(!0),tableProps:(0,o.EW)(()=>({rowKey:u,data:c.value,loading:p.value,checkedRowKeys:m.value,onUpdateCheckedRowKeys:e=>{m.value=e}})),batchProps:(0,o.EW)(()=>({rowKey:u,data:c.value,checkedRowKeys:m.value,onUpdateCheckedRowKeys:e=>{m.value=e}})),pageProps:(0,o.EW)(()=>({page:g.value.page,pageSize:g.value.page_size,itemCount:d.value,onUpdatePage:h,onUpdatePageSize:y}))}}},90216(e,t,a){a.d(t,{A:()=>o});var l=a(45449),n=a(90290);let o=(0,n.pM)({__name:"index",props:(0,n.zz)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,n.zz)(["search"],["update:value"]),setup(e,t){let{expose:a,emit:o}=t,s=(0,n.KR)(null),r=(0,n.fn)(e,"value"),i=()=>{o("search",r.value)};return a({focus:()=>{var e;null==(e=s.value)||e.focus()}}),(t,a)=>{let o=l.A;return(0,n.uX)(),(0,n.Wv)(o,(0,n.v6)({ref_key:"inputRef",ref:s,value:r.value,"onUpdate:value":a[0]||(a[0]=e=>r.value=e)},t.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,n.jR)(i,["enter"])}),(0,n.eX)({_:2},[e.prefix?{name:"prefix",fn:(0,n.k6)(()=>[(0,n.Lk)("div",{class:"flex items-center cursor-pointer",onClick:i},[...a[1]||(a[1]=[(0,n.Lk)("i",{class:"i-mdi-search text-16px"},null,-1)])])]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,n.k6)(()=>[(0,n.Lk)("div",{class:"flex items-center cursor-pointer",onClick:i},[...a[2]||(a[2]=[(0,n.Lk)("i",{class:"i-mdi-search text-16px"},null,-1)])])]),key:"1"}]),1040,["value","style"])}}})},91756(e,t,a){a.d(t,{A:()=>i});var l=a(27546),n=a(29207),o=a(90290);let s={class:"flex gap-10px"},r={class:"flex-center w-40px"},i=(0,o.pM)({__name:"index",props:{data:{type:Array,default:()=>[]},rowKey:{type:Function,required:!0},options:{type:Array,default:()=>[]},checkedRowKeys:{type:Array,default:()=>[]}},emits:["updateCheckedRowKeys","select"],setup(e,t){let{emit:a}=t,i=(0,o.EW)({get:()=>e.checkedRowKeys.length>0&&e.checkedRowKeys.length===e.data.length,set(t){a("updateCheckedRowKeys",t?e.data.map(t=>e.rowKey(t)):[])}}),u=(0,o.EW)(()=>0===e.data.length),p=(0,o.EW)(()=>e.checkedRowKeys.length>0&&e.checkedRowKeys.length<e.data.length),c=(0,o.EW)(()=>0===e.checkedRowKeys.length);return(t,d)=>{let g=n.A,m=l.Ay;return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",r,[(0,o.bF)(g,{checked:(0,o.R1)(i),"onUpdate:checked":d[0]||(d[0]=e=>(0,o.i9)(i)?i.value=e:null),disabled:(0,o.R1)(u),indeterminate:(0,o.R1)(p)},null,8,["checked","disabled","indeterminate"])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,t=>((0,o.uX)(),(0,o.Wv)(m,{key:t.value,disabled:(0,o.R1)(c)||t.disabled,onClick:l=>{a("select",t.value,e.checkedRowKeys)}},{default:(0,o.k6)(()=>[(0,o.eW)((0,o.v_)(t.label),1)]),_:2},1032,["disabled","onClick"]))),128))])}}})},28391(e,t,a){a.d(t,{A:()=>r});var l=a(23995),n=a(27546),o=a(90290);let s={class:"leading-22px text-13px text-desc text-center"},r=(0,o.pM)({__name:"index",setup(e){let t=()=>{window.open("https://github.com/aaPanel/BillionMail/issues")},a=()=>{window.open("https://github.com/aaPanel/BillionMail")};return(e,r)=>{let i=n.Ay,u=(0,o.g2)("i18n-t"),p=l.A;return(0,o.uX)(),(0,o.Wv)(p,null,{default:(0,o.k6)(()=>[(0,o.Lk)("div",s,[(0,o.bF)(u,{tag:"span",scope:"global",keypath:"components.tableHelp.text1"},{issues:(0,o.k6)(()=>[(0,o.bF)(i,{class:"text-13px",type:"primary",text:"",onClick:t},{default:(0,o.k6)(()=>[...r[0]||(r[0]=[(0,o.Lk)("span",null,"Issues",-1),(0,o.Lk)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])]),_:1})]),star:(0,o.k6)(()=>[(0,o.bF)(i,{class:"text-13px",type:"primary",text:"",onClick:a},{default:(0,o.k6)(()=>[...r[1]||(r[1]=[(0,o.eW)(" Star ",-1),(0,o.Lk)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])]),_:1})]),_:1}),r[2]||(r[2]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("span",null,(0,o.v_)(e.$t("components.tableHelp.text2")),1)])]),_:1})}}})},63919(e,t,a){a.d(t,{A:()=>o});var l=a(85684),n=a(90290);let o=(0,n.pM)({__name:"index",setup(e){let t=!!(0,n.Ht)().toolsLeft,a=!!(0,n.Ht)().toolsRight,o=!!(0,n.Ht)().pageLeft||!!(0,n.Ht)().pageRight;return(e,s)=>{let r=l.A;return(0,n.uX)(),(0,n.CE)("div",null,[t||a?((0,n.uX)(),(0,n.Wv)(r,{key:0,class:"items-center mb-12px",justify:"space-between"},{default:(0,n.k6)(()=>[(0,n.bF)(r,{class:"items-center",size:12},{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"toolsLeft")]),_:3}),(0,n.bF)(r,{class:"items-center",size:12},{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"toolsRight")]),_:3})]),_:3})):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"table"),(0,n.R1)(o)?((0,n.uX)(),(0,n.Wv)(r,{key:1,class:"items-center mt-12px",justify:"space-between"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",null,[(0,n.RG)(e.$slots,"pageLeft")]),(0,n.bF)(r,null,{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"pageRight")]),_:3})]),_:3})):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"modal")])}}})},23618(e,t,a){a.d(t,{A:()=>r});var l=a(24259),n=a(90290),o=a(12532);let s={class:"ml-8px text-14px"},r=(0,n.pM)({__name:"index",props:(0,n.zz)({storeKey:{default:""},pageSizes:{default:()=>[10,20,50,100]},showTotal:{type:Boolean,default:!0},showSizePicker:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0},onUpdatePage:{}},{page:{},pageModifiers:{},pageSize:{},pageSizeModifiers:{}}),emits:(0,n.zz)(["refresh"],["update:page","update:pageSize"]),setup(e,t){let{emit:a}=t,r=(0,n.EW)(()=>{let{storeKey:t}=e;return t?`${t}-page`:""}),i=(0,n.fn)(e,"page"),u=(0,n.fn)(e,"pageSize"),p=t=>{var l;null==(l=e.onUpdatePage)||l.call(e,t),a("refresh")},c=t=>{var l;i.value=1,null==(l=e.onUpdatePage)||l.call(e,1),d(t),a("refresh")},d=e=>{r.value&&(0,o.ZB)(r.value,String(e))};if(r.value){let e=(0,o.Lg)(r.value);e&&(u.value=(0,o.WZ)(e))}return(t,a)=>{let o=l.A;return(0,n.uX)(),(0,n.Wv)(o,(0,n.v6)(t.$attrs,{page:i.value,"onUpdate:page":[a[0]||(a[0]=e=>i.value=e),p],"page-size":u.value,"onUpdate:pageSize":[a[1]||(a[1]=e=>u.value=e),c],"show-size-picker":e.showSizePicker,"show-quick-jumper":e.showQuickJumper,"page-sizes":e.pageSizes,"display-order":["pages","size-picker","quick-jumper"]}),(0,n.eX)({_:2},[e.showTotal?{name:"suffix",fn:(0,n.k6)(e=>{let{itemCount:t}=e;return[(0,n.Lk)("span",s," Total "+(0,n.v_)(t),1)]}),key:"0"}:void 0]),1040,["page","page-size","show-size-picker","show-quick-jumper","page-sizes"])}}})},26462(e,t,a){a.r(t),a.d(t,{default:()=>$});var l=a(63919),n=a(23618),o=a(91756),s=a(77625),r=a(28391),i=a(90216),u=a(90290),p=a(27546),c=a(23254),d=a(85684),g=a(95403),m=a(12532),f=a(60045),v=a(80111),h=a(3733),y=a(13665),k=a(60319),b=a(60801),x=a(45449),_=a(96833),R=a(3401);let w={class:"pt-12px"},A={class:"flex-1"},F={class:"mt-8px text-desc"},K={class:"mr-4px"},z=`email,attributes
example1@example.com,"{""age"": ""13"", ""Gender"": ""XXX""}"
example2@example.com,"{""age"": ""45"", ""city"": ""XXX""}"
`,C=(0,u.pM)({__name:"GroupAdd",setup(e){let{t}=(0,R.s9)(),a=(0,u.rk)("formRef"),l=(0,u.Kh)({create_type:2,name:"",description:"",double_optin:0,file_data:"",file_type:""}),n={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},o=[{label:"Single Opt-in",value:0},{label:"Double Opt-in",value:1}],s=e=>{let t=new FileReader;t.onload=t=>{var a;l.file_type=e.name.substring(e.name.lastIndexOf(".")+1),l.file_data=null==(a=t.target)?void 0:a.result},e.file&&t.readAsText(e.file)},r=async()=>{await (0,_.PE)({file_path:"./template/example_recipients.csv"})},[i,c]=(0,f.h)({onChangeState:e=>{e&&(l.name="")},onConfirm:async()=>{var e;await (null==(e=a.value)?void 0:e.validate()),await (0,h.wj)((0,u.ux)(l));let t=c.getState();null==t||t.refresh()}});return(e,c)=>{let d=x.A,m=b.Ay,f=g.A,v=k.A,h=p.Ay,_=y.A;return(0,u.uX)(),(0,u.Wv)((0,u.R1)(i),{title:(0,u.R1)(t)("contacts.group.add.title"),width:"540"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",w,[(0,u.bF)(_,{ref_key:"formRef",ref:a,model:(0,u.R1)(l),rules:n},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:(0,u.R1)(t)("contacts.group.form.name"),path:"name"},{default:(0,u.k6)(()=>[(0,u.bF)(d,{value:(0,u.R1)(l).name,"onUpdate:value":c[0]||(c[0]=e=>(0,u.R1)(l).name=e)},null,8,["value"])]),_:1},8,["label"]),(0,u.bF)(m,{label:"List Type"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{value:(0,u.R1)(l).double_optin,"onUpdate:value":c[1]||(c[1]=e=>(0,u.R1)(l).double_optin=e),options:o},null,8,["value"])]),_:1}),(0,u.bF)(m,{label:(0,u.R1)(t)("contacts.group.form.file"),path:"file_data"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",A,[(0,u.bF)(v,{"is-upload":!1,"max-size":10,accept:["csv"],onChange:s}),(0,u.Lk)("div",F,[(0,u.Lk)("span",K,(0,u.v_)((0,u.R1)(t)("contacts.group.fileUpload.hint")),1),(0,u.bF)(h,{text:"",type:"primary",onClick:r},{default:(0,u.k6)(()=>[(0,u.eW)((0,u.v_)(e.$t("common.actions.download")),1)]),_:1})])])]),_:1},8,["label"]),(0,u.bF)(m,{label:"Example raw CSV"},{default:(0,u.k6)(()=>[(0,u.Lk)("pre",{class:"csv-example"},(0,u.v_)(z))]),_:1})]),_:1},8,["model"])])]),_:1},8,["title"])}}}),W=(0,a(64901).default)(C,[["__scopeId","data-v-36cbe48c"]]),S={class:"pt-12px"},L=(0,u.pM)({__name:"GroupRename",setup(e){let{t}=(0,R.s9)(),a=(0,u.rk)("formRef"),l=(0,u.Kh)({group_id:0,name:""}),n={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},[o,s]=(0,f.h)({onChangeState:e=>{if(e){let{row:e}=s.getState();e&&(l.group_id=e.id,l.name=e.name)}else l.group_id=0,l.name=""},onConfirm:async()=>{var e;await (null==(e=a.value)?void 0:e.validate()),await (0,h.vW)((0,u.ux)(l));let t=s.getState();null==t||t.refresh()}});return(e,s)=>{let r=x.A,i=b.Ay,p=y.A;return(0,u.uX)(),(0,u.Wv)((0,u.R1)(o),{title:(0,u.R1)(t)("contacts.group.rename.title"),width:"400"},{default:(0,u.k6)(()=>[(0,u.Lk)("div",S,[(0,u.bF)(p,{ref_key:"formRef",ref:a,model:(0,u.R1)(l),rules:n},{default:(0,u.k6)(()=>[(0,u.bF)(i,{label:(0,u.R1)(t)("contacts.group.form.name"),path:"name"},{default:(0,u.k6)(()=>[(0,u.bF)(r,{value:(0,u.R1)(l).name,"onUpdate:value":s[0]||(s[0]=e=>(0,u.R1)(l).name=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var X=a(75220);function M(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,u.vv)(e)}let $=(0,u.pM)({__name:"index",setup(e){let{t}=(0,R.s9)(),a=(0,X.rd)(),{tableProps:y,pageProps:k,batchProps:b,tableParams:x,fetchTable:_}=(0,v.u)({params:{page:1,page_size:10,keyword:""},fetchFn:h.oq}),w=(0,u.KR)([{type:"selection"},{key:"name",title:t("contacts.group.columns.name"),minWidth:120,render:e=>(0,u.bF)(p.Ay,{text:!0,type:"primary",onClick:()=>{a.push({path:"/contacts/subscribers",state:{group_id:e.id}})}},{default:()=>[e.name]})},{key:"total_count",title:t("contacts.group.columns.subscribers"),minWidth:100,render:e=>(0,u.bF)(c.Ay,{size:"small",type:"primary",bordered:!1},{default:()=>[e.total_count-e.unsubscribe_count]})},{key:"double_optin",title:t("contacts.group.columns.type"),minWidth:100,render:e=>1===e.double_optin?t("contacts.group.type.doubleOptin"):t("contacts.group.type.singleOptin")},{key:"create_time",title:t("contacts.group.columns.createdAt"),minWidth:140,render:e=>(0,m.fU)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:180,render:e=>{let a,l,n;return(0,u.bF)(d.A,{inline:!0},{default:()=>[(0,u.bF)(p.Ay,{type:"primary",text:!0,onClick:()=>{E(e)}},M(a=t("common.actions.settings"))?a:{default:()=>[a]}),(0,u.bF)(p.Ay,{type:"primary",text:!0,onClick:()=>{G(e)}},M(l=t("common.actions.edit"))?l:{default:()=>[l]}),(0,u.bF)(p.Ay,{type:"error",text:!0,onClick:()=>{O(e)}},M(n=t("common.actions.delete"))?n:{default:()=>[n]})]})}}]),A=[{label:t("common.actions.export"),value:"export"}],F=(e,t)=>{"export"===e&&z(t)},K=(0,u.KR)([{label:"CSV",value:"csv"},{label:"TXT",value:"txt"}]),z=e=>{let a=(0,u.KR)("csv");(0,m.lJ)({title:t("contacts.group.export.title"),content:()=>(0,u.bF)(u.FK,null,[(0,u.bF)("div",{class:"mb-10px"},[t("contacts.group.export.confirm",{count:e.length})]),(0,u.bF)("div",{class:"flex"},[(0,u.bF)(g.A,{value:a.value,options:K.value,"onUpdate:value":e=>{a.value=e}},null)])]),onConfirm:async()=>{await (0,h.qD)({format:a.value,include_unsubscribe:!0,group_ids:e,export_type:1})}})},[C,S]=(0,f.h)({component:W,state:{refresh:_}}),$=()=>{S.open()},E=e=>{a.push(`/contacts/settings/${e.id}`)},[U,j]=(0,f.h)({component:L,state:{refresh:_}}),G=e=>{j.setState({row:e}),j.open()},O=e=>{(0,m.lJ)({title:t("contacts.group.delete.title"),content:t("contacts.group.delete.confirm",{name:e.name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,h.Ni)({group_ids:[e.id]}),_()}})};return(e,a)=>{let c=i.A,d=r.A,g=s.A,m=o.A,f=n.A,v=l.A;return(0,u.uX)(),(0,u.Wv)(v,null,{toolsLeft:(0,u.k6)(()=>[(0,u.bF)((0,u.R1)(p.Ay),{type:"primary",onClick:$},{default:(0,u.k6)(()=>[...a[2]||(a[2]=[(0,u.eW)("Add group",-1)])]),_:1})]),toolsRight:(0,u.k6)(()=>[(0,u.bF)(c,{value:(0,u.R1)(x).keyword,"onUpdate:value":a[0]||(a[0]=e=>(0,u.R1)(x).keyword=e),width:280,placeholder:(0,u.R1)(t)("contacts.group.search.namePlaceholder"),onSearch:a[1]||(a[1]=()=>(0,u.R1)(_)(!0))},null,8,["value","placeholder"])]),table:(0,u.k6)(()=>[(0,u.bF)(g,(0,u.v6)((0,u.R1)(y),{columns:(0,u.R1)(w)}),{empty:(0,u.k6)(()=>[(0,u.bF)(d)]),_:1},16,["columns"])]),pageLeft:(0,u.k6)(()=>[(0,u.bF)(m,(0,u.v6)((0,u.R1)(b),{options:A,onSelect:F}),null,16)]),pageRight:(0,u.k6)(()=>[(0,u.bF)(f,(0,u.v6)((0,u.R1)(k),{onRefresh:(0,u.R1)(_)}),null,16,["onRefresh"])]),modal:(0,u.k6)(()=>[(0,u.bF)((0,u.R1)(C)),(0,u.bF)((0,u.R1)(U))]),_:1})}}})},85684(e,t,a){a.d(t,{A:()=>m});var l=a(44041),n=a(90290),o=a(49359),s=a(50922),r=a(79623),i=a(75454),u=a(69598),p=a(14957),c=a(20649);let d={name:"Flex",self:function(){return c.A}},g=Object.assign(Object.assign({},o.A.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),m=(0,n.pM)({name:"Flex",props:g,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:a}=(0,s.Ay)(e),u=(0,o.A)("Flex","-flex",void 0,d,e,t);return{rtlEnabled:(0,r.I)("Flex",a,t),mergedClsPrefix:t,margin:(0,n.EW)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,i.cF)("gap",t)]:a}}=u.value,{row:n,col:o}=(0,l.t8)(a);return{horizontal:(0,l.eV)(o),vertical:(0,l.eV)(n)}})}},render(){let{vertical:e,reverse:t,align:a,inline:l,justify:o,margin:s,wrap:r,mergedClsPrefix:i,rtlEnabled:c}=this,d=(0,u.B)((0,p.$)(this),!1);return d.length?(0,n.h)("div",{role:"none",class:[`${i}-flex`,c&&`${i}-flex--rtl`],style:{display:l?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:o,flexWrap:!r||e?"nowrap":"wrap",alignItems:a,gap:`${s.vertical}px ${s.horizontal}px`}},d):null}})}}]);